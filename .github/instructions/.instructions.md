# GitHub Copilot Instructions

## Project Overview
This is a **Symfony 7.4** e-commerce application. Follow these guidelines when generating code suggestions.

## Important Project Rules

### Documentation
- **NEVER create summary or implementation documentation files** (e.g., SUMMARY.md, IMPLEMENTATION.md, CHECKLIST.md, etc.) unless explicitly requested by the user
- Only create technical documentation when specifically asked
- Focus on code implementation, not documentation files

### Administration Scoping
- **Always scope administration features under `/admin` path** for routes
- **Always use `Admin` or `Administration` namespace** for admin-related code
- Examples:
  - Routes: `/admin/login`, `/admin/dashboard`, `/admin/products`
  - Namespaces: `Wsei\Ecommerce\Controller\Admin`, `Wsei\Ecommerce\Service\Administration`
  - Templates: `templates/admin/`, `templates/admin/security/`
  - CSS: `public/css/admin/`
  - Providers: `admin_user_provider` not `app_user_provider`
- Keep admin functionality clearly separated from public-facing features

## Symfony-Specific Guidelines

### Framework Conventions
- Follow Symfony best practices and conventions
- Use Symfony's dependency injection container
- Leverage Symfony components (Form, Validator, Security, etc.)
- Use attributes for routing, validation, and ORM mapping
- Follow the Symfony directory structure

### Controllers
- Extend `AbstractController`
- Use constructor injection for dependencies
- Return `Response` objects from controller actions
- Use route attributes: `#[Route('/path', name: 'route_name')]`

### Services
- Auto-configure services in `services.yaml`
- Use constructor injection
- Tag services when needed
- Keep services focused on single responsibility

### Doctrine ORM
- Use attributes for entity mapping
- Define repositories as services
- Use QueryBuilder for complex queries
- Implement custom repository methods

### Forms
- Create FormType classes for forms
- Use form themes for consistent styling
- Implement CSRF protection (enabled by default)

## Coding Standards

### PHP
- Use PHP 8.0+ features where applicable
- Follow PSR-12 coding standards
- Use strict types: `declare(strict_types=1);`
- Prefer type hints for parameters and return types
- Use meaningful variable and function names
- Follow camelCase for methods and variables, PascalCase for classes

### Code Organization
- Keep controllers thin, move business logic to services
- Use dependency injection over static calls
- Implement repository pattern for data access
- Separate concerns: controllers, models, services, repositories

### Security
- Always sanitize user input
- Use prepared statements for database queries
- Implement CSRF protection for forms
- Hash passwords using `password_hash()` with bcrypt
- Validate and escape output to prevent XSS
- Use environment variables for sensitive configuration

### Database
- Use PDO for database connections
- Prefer migrations for schema changes
- Index foreign keys and frequently queried columns
- Use transactions for related operations
- Follow naming conventions: snake_case for tables and columns

### Frontend
- Keep JavaScript modular and maintainable
- Use modern ES6+ syntax
- Implement progressive enhancement
- Ensure responsive design
- Follow accessibility best practices (ARIA labels, semantic HTML)

### Comments and Documentation
- Write PHPDoc blocks for classes and methods
- Comment complex business logic
- Keep comments up-to-date with code changes
- Document API endpoints and their parameters

## Best Practices

### Error Handling
- Use try-catch blocks for expected exceptions
- Log errors appropriately
- Show user-friendly error messages
- Never expose sensitive information in errors

### Performance
- Implement caching where appropriate
- Optimize database queries (avoid N+1 problems)
- Lazy load resources when possible
- Minimize database calls

### Testing
- Write unit tests for business logic
- Test edge cases and error conditions
- Use meaningful test names that describe behavior

## File Structure
- Controllers: `/src/Controller/`
- Entities: `/src/Entity/`
- Forms: `/src/Form/`
- Repositories: `/src/Repository/`
- Services: `/src/Service/`
- Templates: `/templates/`
- Public assets: `/public/`
- Configuration: `/config/`
- Migrations: `/migrations/`

## Common Patterns

### Controller Example
```php
#[Route('/product')]
class ProductController extends AbstractController {
    public function __construct(
        private ProductService $productService
    ) {}
    
    #[Route('/{id}', name: 'product_show', methods: ['GET'])]
    public function show(int $id): Response {
        $product = $this->productService->findById($id);
        
        return $this->render('product/show.html.twig', [
            'product' => $product,
        ]);
    }
}
```

### Entity Example
```php
#[ORM\Entity(repositoryClass: ProductRepository::class)]
class Product {
    #[ORM\Id]
    #[ORM\GeneratedValue]
    #[ORM\Column]
    private ?int $id = null;
    
    #[ORM\Column(length: 255)]
    private ?string $name = null;
}
```

### Service Example
```php
class ProductService {
    public function __construct(
        private ProductRepository $repository
    ) {}
    
    public function findById(int $id): ?Product {
        return $this->repository->find($id);
    }
}
```

## Avoid
- Global variables
- Superglobal arrays ($_GET, $_POST) in business logic
- SQL injection vulnerabilities
- Hardcoded credentials
- Mixing HTML and PHP logic excessively
- Using deprecated PHP functions
- Hardcoding routes instead of using `path()` or `url()` functions
- Bypassing Symfony's service container
